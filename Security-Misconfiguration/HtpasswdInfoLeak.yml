---
id: HTPASSWD_INFO_LEAK
info:
  name: "Htaccess Information Leak"
  description: >
  details: >
  impact: >

  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: HTPASSWD_INFO_LEAK
  severity: LOW
  # TODO: fix references, cve, cwe.
  references:
    - https://www.zaproxy.org/docs/alerts/10044-2/
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245

api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar
  
execute:
  type: single
  requests:
    - req: 
      modify_url: ${urlVar}/.htpasswd

validate:
  response_code:
    gte: 200
    lt: 300
  or: 
  response_headers:
    for_one:
      key: content-type
      value:
        not_contains:
          - xml
          - json
          - html

strategy:
  run_once: /
